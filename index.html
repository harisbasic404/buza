<!DOCTYPE html>
<html lang="hr">
<head>
    <meta charset="UTF-8">
    <title>Buza Igra</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="buza.png">
    <style>
        body {
            background: #181a20;
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 400px;
            margin: 24px auto 0;
            padding: 18px 18px 12px 18px;
            border-radius: 12px;
            background: #23262f;
            box-shadow: 0 4px 28px #0005;
        }
        .game-container {
            position: relative;
            background: #23262f;
            border-radius: 12px;
            padding: 18px 12px 12px 12px;
        }
        #game-title {
            color: #fff;
            font-size: 2rem;
            text-align: center;
            margin: 0 0 10px 0;
            letter-spacing: 2px;
        }
        #score {
            color: #fff;
            font-size: 1.15rem;
            text-align: right;
            margin-bottom: 4px;
        }
        #gameCanvas {
            display: block;
            margin: 0 auto;
            background: #1a1c23;
            border-radius: 14px;
            width: 350px;
            height: 160px;
            max-width: 98vw;
            box-shadow: 0 2px 12px #0004;
            touch-action: none;
        }
        #restartBtn {
            background: #f9d923;
            color: #181a20;
            border: none;
            border-radius: 8px;
            padding: 10px 32px;
            font-size: 1.18rem;
            font-weight: bold;
            margin: 20px auto 0;
            display: block;
            cursor: pointer;
            box-shadow: 0 1px 8px #0002;
            transition: background 0.2s;
        }
        #restartBtn:hover {
            background: #f7c600;
        }
        .footer {
            color: #aaa;
            text-align: center;
            font-size: 0.95em;
            margin-top: 14px;
            margin-bottom: 10px;
        }
        /* Fullscreen button style */
        #fullscreenBtn {
            background: none;
            border: none;
            cursor: pointer;
            outline: none;
            margin-bottom: 7px;
            padding: 0 4px;
        }
        #fullscreenBtn svg {
            vertical-align: middle;
            filter: drop-shadow(0 1px 3px #0007);
            transition: fill 0.2s;
        }
        #fullscreenBtn:hover svg {
            fill: #f9d923;
        }
        @media (max-width: 600px) {
            .container,
            .game-container {
                padding: 8px 1vw;
                max-width: 100vw;
            }
            #gameCanvas {
                width: 98vw !important;
                height: 46vw !important;
                min-height: 160px !important;
                max-width: 100vw;
                max-height: 340px;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <div class="game-container">
        <div style="text-align:right;">
            <button id="fullscreenBtn" title="Prikaži u punom ekranu">
                <svg height="28" width="28" viewBox="0 0 24 24" fill="#fff"><path d="M7 14H5v5h5v-2H7v-3zm12 5h-3v2h5v-5h-2v3zM7 5h3V3H5v5h2V5zm12 0v3h2V3h-5v2h3z"/></svg>
            </button>
        </div>
        <div id="game-title">BUZA</div>
        <div id="score">Rezultat: <span id="scoreNum">0</span></div>
        <canvas id="gameCanvas" width="350" height="160"></canvas>
        <button id="restartBtn" style="display:none;">Ponovo</button>
        <audio id="sliceSound" preload="auto">
            <source src="slice.m4a" type="audio/mp4">
            <source src="slice.mp3" type="audio/mpeg">
        </audio>
    </div>
    <div class="footer">
        &copy; 2024 | Buza igra | harisbasic404
    </div>
</div>
<script>
    // --- Setup
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    let W = canvas.width, H = canvas.height;
    const scoreNum = document.getElementById('scoreNum');
    const restartBtn = document.getElementById('restartBtn');
    const sliceSound = document.getElementById('sliceSound');

    // --- Assets
    const headImg = new Image();
    headImg.src = "buza.png";
    // --- Glava objekat
    let head = {
        x: 80, y: 340, w: 80, h: 80,
        vx: 2 + Math.random()*2, vy: -(14 + Math.random()*6), // veći skok!
        gravity: 0.32,
        alive: true,
        sliced: false,
        rot: 0,
        vrot: (Math.random()-0.5)*0.2
    };
    let score = 0, isGameOver = false;
    // --- Responzivni canvas
    function resizeCanvas() {
        if (window.innerWidth < 600) {
            canvas.width = window.innerWidth * 0.98;
            canvas.height = canvas.width * 0.47;
        } else {
            canvas.width = 350;
            canvas.height = 160;
        }
        W = canvas.width;
        H = canvas.height;
    }
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    // --- Crtanje
    function drawHead() {
        ctx.save();
        ctx.translate(head.x + head.w/2, head.y + head.h/2);
        ctx.rotate(head.rot);
        ctx.drawImage(headImg, -head.w/2, -head.h/2, head.w, head.h);
        ctx.restore();
    }
    function draw() {
        ctx.clearRect(0,0,W,H);
        if(head.alive) drawHead();
        if(isGameOver) {
            ctx.fillStyle = "#222c";
            ctx.fillRect(0,0,W,H);
            ctx.fillStyle = "#fff";
            ctx.font = "bold 2.2rem Arial";
            ctx.textAlign = "center";
            ctx.fillText("KRAJ IGRE", W/2, H/2-7);
            ctx.font = "1.1rem Arial";
            ctx.fillText("Rezultat: "+score, W/2, H/2+26);
        }
    }

    // --- Animacija
    function update() {
        if(!head.alive) return;
        head.x += head.vx;
        head.y += head.vy;
        head.vy += head.gravity;
        head.rot += head.vrot;
        // Odbijanje od zidova
        if(head.x < 0) { head.x=0; head.vx*=-1; head.vrot*=-1; }
        if(head.x + head.w > W) { head.x=W-head.w; head.vx*=-1; head.vrot*=-1; }
        // Kraj igre?
        if(head.y > H) {
            head.alive = false;
            isGameOver = true;
            restartBtn.style.display = "block";
        }
    }
    function loop() {
        update();
        draw();
        requestAnimationFrame(loop);
    }
    headImg.onload = () => loop();

    // --- Kontrole
    function pointInHead(x, y) {
        return x > head.x && x < head.x+head.w && y > head.y && y < head.y+head.h;
    }
    function trySlice(x, y, px, py) {
        if(!head.alive) return;
        if(pointInHead(x, y) || (px && pointInHead(px, py))) {
            if (sliceSound) {
                sliceSound.currentTime = 0;
                sliceSound.play();
            }
            head.sliced = true;
            score++;
            scoreNum.textContent = score;
            spawnHead();
        }
    }
    // Dodir/mis
    let dragging=false, lastX=0, lastY=0;
    canvas.addEventListener('mousedown', e=>{
        dragging=true;
        lastX = e.offsetX; lastY = e.offsetY;
    });
    canvas.addEventListener('mousemove', e=>{
        if(!dragging) return;
        trySlice(e.offsetX, e.offsetY, lastX, lastY);
        lastX = e.offsetX; lastY = e.offsetY;
    });
    canvas.addEventListener('mouseup', ()=>dragging=false);
    canvas.addEventListener('mouseleave', ()=>dragging=false);
    // Touch
    canvas.addEventListener('touchstart', e=>{
        dragging=true;
        const rect = canvas.getBoundingClientRect();
        const t = e.touches[0];
        lastX = (t.clientX-rect.left)*canvas.width/rect.width;
        lastY = (t.clientY-rect.top)*canvas.height/rect.height;
    });
    canvas.addEventListener('touchmove', e=>{
        if(!dragging) return;
        const rect = canvas.getBoundingClientRect();
        const t = e.touches[0];
        let x = (t.clientX-rect.left)*canvas.width/rect.width;
        let y = (t.clientY-rect.top)*canvas.height/rect.height;
        trySlice(x, y, lastX, lastY);
        lastX = x; lastY = y;
    });
    canvas.addEventListener('touchend', ()=>dragging=false);

    // --- Nova glava
    function spawnHead() {
        head.x = Math.random()*(W-80);
        head.y = H-40;
        head.w = 80;
        head.h = 80;
        head.vx = 2 + Math.random()*2;
        head.vy = - (14 + Math.random()*7); // veći skok!
        head.gravity = 0.32;
        head.sliced = false;
        head.alive = true;
        head.rot = 0;
        head.vrot = (Math.random()-0.5)*0.2;
    }
    // --- Restart
    restartBtn.addEventListener('click', ()=>{
        isGameOver = false;
        score = 0;
        scoreNum.textContent = 0;
        spawnHead();
        restartBtn.style.display = "none";
        loop();
    });

    // --- Fullscreen
    document.getElementById('fullscreenBtn').addEventListener('click', function() {
        let el = document.querySelector('.game-container');
        if (!document.fullscreenElement) {
            el.requestFullscreen();
        } else {
            document.exitFullscreen();
        }
    });
</script>
</body>
</html>
